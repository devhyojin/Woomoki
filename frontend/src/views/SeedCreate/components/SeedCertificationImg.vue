<template>
  <v-hover>
    <template v-slot:default="{ hover }"> 
      <v-avatar
          tile
          :class="`rounded-lg`"
          width="100%"
          height="100%"
          max-width="100%"
          max-height="100%"
          color="#AED864"
          class="cursor-img"
          @click="onClickImageUpload"
          >
          <v-img
            :class="`rounded-lg`"
            width="100%"
            height="100%"
            max-width="100%"
            max-height="100%"
            v-if="imageUrl"
            :src="imageUrl"
            @click="onClickImageUpload"
          >
            <v-fade-transition>
              <v-overlay
                v-if="hover"
                absolute
                color="#036358"
              >
                <v-btn>인증 예시 사진 변경<input ref="imageInput" type="file" hidden @change="onChangeImages"></v-btn>
              </v-overlay>
            </v-fade-transition>
          </v-img>
        
        <!-- <v-fade-transition>
          <v-overlay
            v-if="hover"
            absolute
            color="#036358"
          >
            <v-btn>인증 예시 사진 변경<input ref="imageInput" type="file" hidden @change="onChangeImages"></v-btn>
          </v-overlay>
        </v-fade-transition> -->
      </v-avatar>
    </template>
  </v-hover>
</template>

<script>
  import AWS from 'aws-sdk'

  export default {
    name: "SeedCertificationImg",
    data: function () {
      return {
        text: "인증 예시 사진",
        imageUrl: "https://t1.daumcdn.net/thumb/R720x0/?fname=http://t1.daumcdn.net/brunch/service/user/1P88/image/MK3vcYmgiNjgHG0lyRfRPRxtW7M.jpg",
        fileName: null,
        file: null,
        selectedImage: null,

      }
    },
    methods: {
      onClickImageUpload() {
        this.$refs.imageInput.click();
      },
      onChangeImages(e) {
        console.log(e.target.files)
        this.file = e.target.files[0]; // Get first index in files
        this.imageUrl = URL.createObjectURL(this.file); // Create File URL
        this.fileNameSetting();
        this.transferCertificationImg();
      },
      onDeleteImage() {
        this.text = "인증 사진 변경"
        this.imageUrl = ""
        this.fileName = ""
        this.file = ""
      },
      transferCertificationImg: function () {
        this.$emit('transferCertificationImg', this.file, this.fileName)
      },
      async fileNameSetting() {

        const user_id = this.$store.state.UserStore.user.user_id;

        var now = new Date();

        var year = now.getFullYear(); // 연도
        var month = now.getMonth() + 1; // 월
        var date = now.getDate(); // 일
        var hours = now.getHours(); // 시간
        var minutes = now.getMinutes(); // 분
        var seconds = now.getSeconds(); // 초
        var milliseconds = now.getMilliseconds(); // 밀리초

        // console.log("현재 : ", now);
        var realtime = year + "" + month + "" + date + "_" + hours + minutes + seconds + milliseconds;
        console.log(realtime);

        this.fileName = user_id + "_" + realtime + "_" + this.file.name

      },
    }
  }
</script>

<style scoped>
  .cursor-img {
    cursor: pointer;
  }
</style>